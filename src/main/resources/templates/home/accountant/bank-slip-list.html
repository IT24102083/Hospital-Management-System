<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Slip Verifications - HealthFirst</title>
    <link rel="icon" type="image/png" href="https://img.icons8.com/color/48/medical-cross.png">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; opacity: 0; }
        .hero-gradient { background: linear-gradient(135deg, rgba(236, 253, 245, 0.8) 0%, rgba(14, 116, 144, 0.1) 100%); }
        .table-row-hover:hover { background-color: #f9fafb; transform: translateY(-2px); transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .status-badge { padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; }
        .status-pending { background-color: #fef3c7; color: #92400e; }
        html, body { -ms-overflow-style: none; scrollbar-width: none; }
        html::-webkit-scrollbar, body::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-gray-100 font-sans">

<nav id="navbar" class="fixed w-full bg-white/90 backdrop-blur-sm z-50 shadow-sm transition-all duration-300">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
        <a href="/dashboard" class="flex items-center">
            <i class="fas fa-heartbeat text-blue-600 text-2xl mr-2"></i>
            <span class="text-xl font-bold">Health<span class="text-blue-600">First</span></span>
        </a>
        <div class="flex items-center space-x-4">
            <a href="/dashboard" class="text-gray-700 hover:text-blue-600 font-medium">
                <i class="fas fa-chart-line mr-2"></i> Dashboard
            </a>
            <a href="/logout" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg">
                <i class="fas fa-sign-out-alt mr-2"></i> Logout
            </a>
        </div>
    </div>
</nav>

<main class="pt-24 pb-16 min-h-screen hero-gradient">
    <div class="container mx-auto px-4">
        <div class="max-w-7xl mx-auto">
            <!-- Header Section -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-6">
                <div class="bg-gradient-to-r from-green-600 to-blue-600 text-white p-6">
                    <div class="flex justify-between items-center">
                        <div>
                            <h1 class="text-3xl font-bold">Bank Slip Verifications</h1>
                            <p class="text-green-100 mt-2">Review and verify pending bank transfer receipts</p>
                        </div>
                        <div class="bg-white/20 backdrop-blur-sm rounded-lg p-4">
                            <div class="text-center">
                                <div class="text-3xl font-bold" th:text="${totalPending}">0</div>
                                <div class="text-sm text-green-100">Pending Verifications</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Success/Error Messages -->
                <div th:if="${success}" class="bg-green-50 border-l-4 border-green-500 p-4 m-6">
                    <div class="flex">
                        <i class="fas fa-check-circle text-green-500 text-xl mr-3"></i>
                        <p class="text-green-700 font-medium" th:text="${success}">Success message</p>
                    </div>
                </div>

                <div th:if="${error}" class="bg-red-50 border-l-4 border-red-500 p-4 m-6">
                    <div class="flex">
                        <i class="fas fa-exclamation-circle text-red-500 text-xl mr-3"></i>
                        <p class="text-red-700 font-medium" th:text="${error}">Error message</p>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6">
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600 font-medium">Pending Today</p>
                                <p class="text-2xl font-bold text-yellow-700" th:text="${pendingBankSlips.numberOfElements}">0</p>
                            </div>
                            <i class="fas fa-clock text-yellow-500 text-3xl"></i>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600 font-medium">Total Pending</p>
                                <p class="text-2xl font-bold text-blue-700" th:text="${totalPending}">0</p>
                            </div>
                            <i class="fas fa-file-invoice text-blue-500 text-3xl"></i>
                        </div>
                    </div>

                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600 font-medium">Pages</p>
                                <p class="text-2xl font-bold text-green-700" th:text="${pendingBankSlips.totalPages}">0</p>
                            </div>
                            <i class="fas fa-layer-group text-green-500 text-3xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Bank Slips Table -->
                <div class="p-6">
                    <div th:if="${pendingBankSlips.content.size() == 0}" class="text-center py-12">
                        <i class="fas fa-check-circle text-green-500 text-6xl mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-700 mb-2">All Caught Up!</h3>
                        <p class="text-gray-600">No pending bank slips to verify at the moment.</p>
                    </div>

                    <div th:if="${pendingBankSlips.content.size() > 0}" class="overflow-x-auto">
                        <table class="min-w-full bg-white rounded-lg overflow-hidden">
                            <thead class="bg-gray-100 border-b-2 border-gray-200">
                            <tr>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    Payment Date
                                </th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    Patient
                                </th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    Invoice
                                </th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    Amount
                                </th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    Reference
                                </th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    Status
                                </th>
                                <th class="px-6 py-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    Actions
                                </th>
                            </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                            <tr th:each="payment : ${pendingBankSlips.content}" class="table-row-hover">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm font-medium text-gray-900" th:text="${#temporals.format(payment.paymentDate, 'MMM dd, yyyy')}">Jan 15, 2024</div>
                                    <div class="text-xs text-gray-500" th:text="${#temporals.format(payment.paymentDate, 'HH:mm')}">14:30</div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10">
                                            <div class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center">
                                                <span class="text-blue-600 font-semibold" th:text="${#strings.substring(payment.patient.firstName, 0, 1) + #strings.substring(payment.patient.lastName, 0, 1)}">JD</span>
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900" th:text="${payment.patient.firstName + ' ' + payment.patient.lastName}">John Doe</div>
                                            <div class="text-xs text-gray-500" th:text="${payment.patient.email}">john@example.com</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm font-medium text-blue-600" th:text="${payment.invoice.invoiceNumber}">INV-2024-145</div>
                                    <div class="text-xs text-gray-500">
                                        Due: <span th:text="${#temporals.format(payment.invoice.dueDate, 'MMM dd')}">Feb 15</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm font-bold text-green-600">
                                        $<span th:text="${#numbers.formatDecimal(payment.amount, 1, 2)}">350.00</span>
                                    </div>
                                    <div class="text-xs text-gray-500">
                                        Balance: $<span th:text="${#numbers.formatDecimal(payment.invoice.balanceDue, 1, 2)}">350.00</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-900" th:text="${payment.referenceNumber}">REF123456</div>
                                    <div class="text-xs text-gray-500" th:if="${payment.bankSlipPath != null}">
                                        <i class="fas fa-paperclip mr-1"></i> Attachment
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="status-badge status-pending">
                                            <i class="fas fa-clock mr-1"></i> Pending
                                        </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-center">
                                    <a th:href="@{/accountant/bank-slips/{id}(id=${payment.id})}"
                                       class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors">
                                        <i class="fas fa-search mr-2"></i> Verify
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <div th:if="${pendingBankSlips.totalPages > 1}" class="mt-6 flex justify-between items-center">
                        <div class="text-sm text-gray-600">
                            Showing <span th:text="${pendingBankSlips.number * pendingBankSlips.size + 1}">1</span>
                            to <span th:text="${(pendingBankSlips.number + 1) * pendingBankSlips.size}">10</span>
                            of <span th:text="${pendingBankSlips.totalElements}">50</span> results
                        </div>

                        <div class="flex space-x-2">
                            <a th:if="${!pendingBankSlips.first}"
                               th:href="@{/accountant/bank-slips(page=${pendingBankSlips.number - 1})}"
                               class="px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm font-medium">
                                <i class="fas fa-chevron-left mr-2"></i> Previous
                            </a>

                            <span class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium">
                                Page <span th:text="${pendingBankSlips.number + 1}">1</span> of <span th:text="${pendingBankSlips.totalPages}">5</span>
                            </span>

                            <a th:if="${!pendingBankSlips.last}"
                               th:href="@{/accountant/bank-slips(page=${pendingBankSlips.number + 1})}"
                               class="px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm font-medium">
                                Next <i class="fas fa-chevron-right ml-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                <a href="/accountant/invoices" class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow">
                    <div class="flex items-center">
                        <div class="bg-blue-100 rounded-full p-3 mr-4">
                            <i class="fas fa-file-invoice text-blue-600 text-2xl"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Manage Invoices</h3>
                            <p class="text-sm text-gray-600">View all invoices</p>
                        </div>
                    </div>
                </a>

                <a href="/accountant/payment-plans" class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow">
                    <div class="flex items-center">
                        <div class="bg-green-100 rounded-full p-3 mr-4">
                            <i class="fas fa-calendar-alt text-green-600 text-2xl"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Payment Plans</h3>
                            <p class="text-sm text-gray-600">Manage installments</p>
                        </div>
                    </div>
                </a>

                <a href="/accountant/reports" class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow">
                    <div class="flex items-center">
                        <div class="bg-purple-100 rounded-full p-3 mr-4">
                            <i class="fas fa-chart-bar text-purple-600 text-2xl"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Financial Reports</h3>
                            <p class="text-sm text-gray-600">View analytics</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
</main>

<footer class="bg-gray-900 text-white pt-16 pb-8 relative">
    <div class="container mx-auto px-4">
        <div class="text-center text-gray-400">
            <p>&copy; 2025 HealthFirst. All rights reserved.</p>
        </div>
    </div>
</footer>

<script>
    // Auto-refresh every 60 seconds to check for new bank slips
    setTimeout(function() {
        location.reload();
    }, 60000);

    // Add fade-in animation to rows
    document.addEventListener('DOMContentLoaded', function() {
        const rows = document.querySelectorAll('.table-row-hover');
        rows.forEach((row, index) => {
            setTimeout(() => {
                row.style.opacity = '0';
                row.style.transform = 'translateY(20px)';
                row.style.transition = 'all 0.3s ease-out';
                setTimeout(() => {
                    row.style.opacity = '1';
                    row.style.transform = 'translateY(0)';
                }, 50);
            }, index * 50);
        });
    });
</script>
</body>
</html>